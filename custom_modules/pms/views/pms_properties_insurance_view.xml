<odoo>

<record id="pms_properties_insurance_view_search" model="ir.ui.view">
        <field name="name">pms.insurance.search</field>
        <field name="model">pms.insurance</field>
        <field name="arch" type="xml">
            <search string="Default Search">
             
                <field name="name" string="Policy Number" />
                <field name="insurance_start"/>
                <field name="insurance_end"/>
                <field name="total_coverage_amount"/>
                <field name="total_premiun_amount"/>
                <field name="days_to_expire"/>
                <field name="open_claim"/>
                <field name="claim_description"/>
                <field name="insurance_provider"/>
                <field name="insurance_agent"/>
                <field name="insurance_type"/>
            </search>
        </field>
</record>

<record id="pms_properties_insurance_view" model="ir.actions.act_window">
    <field name="name">Insurance</field>
    <field name="res_model">pms.insurance</field>
    <field name="view_mode">list,form</field>
</record>

<record id="pms_properties_insurance_view_tree" model="ir.ui.view">
    <field name="name">pms.insurance.tree</field>
    <field name="model">pms.insurance</field>
    <field name="arch" type="xml">
        <list string="Insurance Policies">
            <field name="name" optional="show"/>
            <field name="insurance_end" optional="show"/>
            <field name="total_coverage_amount" optional="show"/>
            <field name="days_to_expire" optional="show"/>
            <field name="total_premiun_amount" optional="show"/>
            <field name="insurance_agent" optional="show"/>
            <field name="insurance_type"/>
            <field name="open_claim"/>
        </list>
    </field>
</record>

<record id="pms_properties_insurance_view_form" model="ir.ui.view">
        <field name="name">pms.insurance.form</field>
        <field name="model">pms.insurance</field>
        <field name="arch" type="xml">
            <form>
                <button id="do_open_claim" name="oopen_claim" string="Open Claim"
                    type="object" class="btn-primary"
                    invisible="open_claim"/>

                <button id="do_close_claim" name="close_claim" string="Close Claim"
                    type="object" class="btn-primary"
                    invisible="not open_claim"/>

                <field name="open_claim" widget="statusbar" statusbar_visible="True, False"/>

                <sheet>
                <group name="Insurance Details">
                <field name="name"/>
                <field name="insurance_provider"/>
                <field name="insurance_agent"/>
                <field name="insurance_start"/>
                <field name="insurance_end"/>
                <field name="total_coverage_amount" readonly="insurance_type != 'liability_insurance'"/>
                <field name="total_premiun_amount"/>
                <field name="days_to_expire"/>
                <field name="insurance_type"/>
                <field name="claim_description" invisible="not open_claim"/>
                </group>

                <notebook>
                <page string="Properties">
                    <field name="insurance_line"/>
                </page>
                
                </notebook>

                </sheet>

                <div class="oe_chatter">
                <field name="message_follower_ids" groups="base.group_user"/>
                <field name="activity_ids"/>
                <field name="message_ids"/>
                </div>
            </form>
        </field>
</record>

<data noupdate="1">
   <record id="ir_cron_days_to_expire" model="ir.cron">
       <field name="name">days_to_expire</field>
       <field name="model_id" ref="model_pms_insurance"/>
       <field name="state">code</field>
       <field name="code">
env['pms.projects'].function_run_log("_days_to_expire")
model.search([])._days_to_expire()
</field>
       <field name="user_id" ref="base.user_root"/>
       <field name="interval_number">1</field>
       <field name="interval_type">days</field>
   </record>
</data>

</odoo>